---

nginx_max_clients: 512

nginx_http_params:
  - sendfile "on"
  - tcp_nopush "on"
  - tcp_nodelay "on"
  - keepalive_timeout "65"
  - access_log "/var/log/nginx/access.log"
  - error_log "/var/log/nginx/error.log"

nginx_sites:
 - server:
    file_name: foo
    vars:
     - listen 8080
     - server_name localhost
     - root "/tmp/site1"
     - location / { try_files $uri $uri/ /index.html; }
     - location /images/ { try_files $uri $uri/ /index.html; }
 - server:
    file_name: bar
    vars:
     - listen 9090
     - server_name ansible
     - root "/tmp/site2"
     - location / { try_files $uri $uri/ /index.html; }
     - location /images/ {
         try_files $uri $uri/ /index.html;
         allow 127.0.0.1;
         deny all;
       }

nginx_configs:
  - config:
     file_name: proxy
     vars:
      - proxy_set_header X-Real-IP  $remote_addr
      - proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for
  - config:
     file_name: upstream
     vars:
      - upstream foo { server 127.0.0.1:8080 weight=10; }
  - config:
     file_name: geo
     vars:
      - geo $local {
          default 0;
          127.0.0.1 1;
        }
  - config:
     file_name: gzip
     vars:
      - gzip on
      - gzip_disable msie6
